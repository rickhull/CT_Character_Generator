require 'pry'
require 'traveller/generator'
require 'traveller/career_path'

# 1. new char, 18 y/o with 2 skills from homeworld and 1+EDU
char = Traveller::Generator.character
path = Traveller::CareerPath.new(char)
puts "#{char.desc.name} has come of age!"

done = false
while !done
  career = Traveller.choose("Choose a career", :scout)
  case career
  when :scout
    career = Traveller::Scout.new
  end

  # HACK
  break unless path.eligible?(career)
  # really, choose a different career

  # skip draft / drifter for now
  accepted = false
  while !accepted
    print "#{char.desc.name} is applying for Scout... "
    accepted = path.apply(career)
    puts accepted ? 'ACCEPTED' : 'REJECTED'
  end

  exit_career = false
  while !exit_career
    path.run_term
    if path.active_career
      if path.must_remain
        exit_career = false
      elsif path.must_exit
        exit_career = true
      else
        choice = Traveller.choose("Continue career?", :yes, :no)
        exit_career = (choice == :no)
      end
    else
      exit_career = true
    end
  end
  if path.active_career
    cash, other = path.muster_out
    puts "Muster Out with #{cash} credits and #{other} benefits"
  end
  puts path.pretty_inspect

  binding.pry

  choice = Traveller.choose("Exit career mode?", :yes, :no)
  done = true if choice == :yes
end
