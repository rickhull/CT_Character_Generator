require 'pry'
require 'traveller/generator'
require 'traveller/career_path'

char = Traveller::Generator.character
path = Traveller::CareerPath.new(char)

careers = %w{Scout}

done = false
while !done
  careers = careers.select { |c| path.eligible? c }
  if careers.empty?
    puts "No eligible careers available!"
    break
  end
  career = Traveller.choose("Choose a career", *careers)
  career = Traveller.career_class(career).new

  # skip draft / drifter for now
  accepted = false
  accepted = path.apply(career) while !accepted

  exit_career = false
  while !exit_career
    path.run_term
    if path.active_career
      if path.must_remain
        exit_career = false
      elsif path.must_exit
        exit_career = true
      else
        choice = Traveller.choose("Continue career?", :yes, :no)
        exit_career = (choice == :no)
      end
    else
      exit_career = true
    end
  end
  path.muster_out if path.active_career
  puts path.pretty_inspect
  done = Traveller.choose("Exit career mode?", :yes, :no) == :yes
end

binding.pry

puts "DONE"
